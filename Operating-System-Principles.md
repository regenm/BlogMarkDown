---
title: Operating System Principles
date: 2024-02-27 19:40:51
tags: [Operating System, 笔记]
---

==操作系统原理==

# 1.操作系统概论

# 2.操作系统接口
## 用户与操作系统接口的分类
1. 用户接口
	提供给用户使用，通过该接口取得操作系统的服务。
2. 程序接口
	提供给程序员使用，用户程序使用系统服务的唯一途径
	
### 用户接口（操作接口）
1. 联机用户接口（交互式）
2. 脱机用户接口（批处理 ）
#### 联机用户接口（交互式）
1. 字符显示式联机用户接口
* 命令行方式：shell 语言
* 批命令方式：.sh
2. 图形化联机用户接口
* GUI ：包括窗口，图标，菜单，鼠标和面向对象技术
#### 脱机用户接口（批处理 ）
	由一组作业控制语言组成。
* 作业：一次应用业务处理中，从输入开始到输入结束。用户要求计算机所做工作的集合。
* 作业步：作业加工处理的技术
* 作业分类：脱机作业，联机作业。
* 作业I/O方式：联机IO，脱机IO，SpooLing方式

## 系统调用
	系统调用（System Call），提供了用户程序和操作系统之间的接口。用户不能直接调用，但是用户程序可以。

### 特权指令和非特权指令
* 特权指令
	不允许用户程序直接使用的指令，关系到系统全局。
	特点：
	1. 内存访问范围不受限制
	2. 用户和系统存储空间都能访问
* 非特权指令
	只能完成一般性的操作和任务，不能直接访问系统的硬件和软件。
	访问范围局限于用户空间
	
### 管态和目态
1. 管态（系统态，核心态）：
	可以执行包括特权指令的所有机器指令。

2. 目态（用户态）：
	不允许执行特权指令。
	
### 系统调用
	系统调用是操作系统提供的一组用于实现各种系统功能的子程序，并将它们提供给应用程序调用。 
==系统调用是应用程序获得操作系统服务的唯一途径！==
* 系统调用会将用户态切换到内核态
* 



# 3. *进程管理

## *进程的基本概念
### 程序
* 程序的特征
1. 顺序性，处理机的操作严格按照程序所规定的顺序执行
2. 封闭性，程序运行时独占全机资源
3. 结果的确定性，执行结果和中断次数无关
4. 可再现性，只要程序顺序执行的环境和初始条件相同，不论执行过程如何，都将获得相同的结果
### 进程
#### 概念
* 非正式
	执行中的程序
	运行中的代码段 
* 正式
	可并发执行的程序在一个数据集合上的执行过程，是系统进行资源分配和调度的一个独立单位
	注意：进程 != 程序
### 进程与程序的关系
#### 比较

｜进程｜程序｜
｜-------｜-------｜
｜动态｜静态｜
｜并发｜顺序｜
｜暂时｜永久｜
* 出现原因：支持多道编程

#### 进程的特征（属性）
特征：
1. 结构特征
进程实体：由程序段、数据段、核心栈及进程控制块部分构成，总称“进程映像”（Process Image）。
2. 动态性(最基本的特征)
由“创建”而产生，由“调度”而执行；由得不到资源而阻塞；由撤消而消亡。（而程序是静态的）。
3. 并发性（重要特征）
只有建立了进程，才能并发执行。
4. 独立性
独立运行，独立获得资源、独立接受调度。
5. 异步性
进程按各自独立、不可预知的速度向前推进




## *进状态及转换
### 进程的三种基本状态
* 就绪状态
* 执行/运行状态
* 阻塞/等待/睡眠/暂停/封锁状态

###进程状态变迁情况及原因：

1. 就绪状态→运行状态：由OS中的进程调度程序，按一定的原则调度就绪队列中进程占用CPU。
2. 运行状态→就绪状态：时间片到，高优先进程进入就绪队列，等等。
3. 运行状态→阻塞状态：等待I/O传输，申请内存空间，程序运行出错，等等。
4. 阻塞状态→就绪状态： I/O传输完成，内存空间获得，程序运行错误处理完成，等等。
#### 进程的五态模型

1. NULL-创建态：新进程的产生
2. 创建态-就绪态：资源允许的情况
3. 执行态-终止态：自然结束，强行终止
4. 终止态-NULL：完成善后操作
5. 阻塞态-终止态：强行终止
6. 就绪态-终止态：强行终止

* 程序状态字PSW（程序状态寄存器）又称（标志寄存器）

​	PSW用来存放两类信息：一类是体现当前指令执行结果的各种状态信息，称为状态标志，如有无进位（CF位），有无溢出（OF位），结果正负（SF位），结果是否为零（ZF位），奇偶标志位（PF位）等；另一类是存放控制信息，称为控制状态，如允许中断(IF位)，跟踪标志（TF位），方向标志(DF)等。

## *进程控制

​	进程控制的职责是对系统中的全部进程实施有效的管理，它是处理机管理的一部分。





## 进程同步

### 进程之间的制约关系

1. 间接制约：资源竞争关系

需互斥地访问临界资源（进程互斥）

* 临界资源：在一个时间段内只允许一个进程访问的资源。
* 临界区（Critical Section，CS）进程访问临界资源的一段代码。

2. 直接制约：相互协作关系

### 进程间资源访问冲突

-共享变量的修改冲突

-操作顺序中冲突

### 进程之间的交互关系

1. 互斥：指多个进程不能同时使用同一个资源
2. 同步：进程之间的协作
3. 死锁：指多个进程互不相让，都得不到足够的资源；

### 锁

锁（共享的变量）阻止了其他进程进入临界区

### 临界区及其管理

​	临界区的执行在时间上是互斥的,进程必须请求允许进入临界区

间接同步（互斥）机制应遵循的准则

（1）空闲让进：当无进程处于临界区时，允许一进程立即进入临界区

（2）忙则等待：当某一进程已进入临界区时，其它试图进入临界区进程必须等待

（3）有限等待：应保证为有限等待，不会产生”死等”状态。（4）让权等待：不能进入临界区的执行进程应放弃CPU执行权。

#### 硬件方式-提供的低级原子级操作

1. 关中断

​	硬件上的关中断（禁止中断）。

* 缺点：
    * 影响计算机效率
    * 在多处理器下方法失效

### 进程死锁

> ​	进程死锁是指两个或多个进程在执行过程中，由于竞争系统资源而造成的一种僵局状态，导致它们永远无法继续执行下去。在死锁状态下，每个进程都在等待系统中的某个资源被释放，而释放该资源的操作又被其他进程所持有，从而导致所有进程都无法继续执行。换句话说，每个进程都在等待其他进程释放资源，而它们自身持有的资源又被其他进程等待，从而形成了一个相互等待的循环，无法解开。

### * 信号量机制（必考）

​	**定义**：信号量机制是操作系统中用于控制对共享资源访问的一种同步机制。它通常用于多进程或多线程环境下，以确保对共享资源的访问不会导致竞态条件或数据不一致的问题。

1. **P操作**
    获取信号量（P操作）：当一个线程或进程需要访问共享资源时，它需要首先尝试获取信号量。获取信号量的操作通常称为 P（或 wait）操作。如果信号量的值大于零，表示有可用的资源，线程或进程可以继续执行；如果信号量的值为零，表示资源已经被占用，线程或进程需要等待，直到有资源可用
2. **V操作**
    释放信号量（V操作）：当线程或进程使用完共享资源后，它需要释放信号量，以允许其他线程或进程继续访问。释放信号量的操作通常称为 V（或 signal）操作。通过增加信号量的值，V操作使得等待中的线程或进程可以继续执行。释放信号量（V操作）：当线程或进程使用完共享资源后，它需要释放信号量，以允许其他线程或进程继续访问。释放信号量的操作通常称为 V（或 signal）操作。通过增加信号量的值，V操作使得等待中的线程或进程可以继续执行。

#### * 信号量分类

**信号量分为：互斥信号量和资源信号量**

* 互斥信号量用于申请或释放资源的使用权，常初始化为1。
* 资源信号量用于申请或归还资源，可以初始化为大于1的正整数，表示系统中某类资源的可用个数。

1. 整形信号量
    1. 设S为一个需要初始化值的整型量，对S的访问仅能通过两个标准的原子操作P(S)和V(S)。**S的初值代表资源的总数**。
    2. 如果S的值为1，表示有1个临界资源可以使用。
    3. 整型信号量S是一个全局变量（整型初始非负），并发进程都能够访问。S需要在主程序中定义，并赋予初值。
2. 记录型信号量
    1. 在整型信号量的基础上进行改进
    2. 让不能进入临界区的进程“让权等待”，即进程状态由运行转换为阻塞状态，进程进入阻塞队列中等待。
    3. Semaphore为一个记录型数据结构
        1. **value：**代表资源数目，具有初值，该初值通常为非负整数。
        2. **L**：是一个初始状态为空的进程阻塞队列。
    4. 工作流程
        1. 记录型信号量的P操作是先减1，再测试，因此，测试条件是小于0，不是小于等于0；记录型信号量的V操作是先加1，再判断是否有进程阻塞，有进程阻塞则唤醒。
        2. 在P(S)操作中，S.value的值小于0时，表示不能访问临界资源，block(S.L)将调用P(S)的进程置成阻塞状态等待。
        3. 在V(S)操作中，S.value的值小于等于0时，表示有进程在阻塞队列等待临界资源，wakeup(S.L)将唤醒一个在阻塞队列等待的进程。
3. AND型信号量
    1. 进程需要的资源越多，出现死锁的可能性也越大
    2. 解决的办法：将进程所需要的资源一次性地全部分配给进程，等进程运行完后再全部一起释放。
    3. **缺点**
        1. 虽然用AND型信号量会避免进程死锁，但是，AND型信号量使得并发进程变为先后执行，进程之间的相互等待，使得系统整体性能降低。

4. 信号量集
    1. 使用原因：
        1. 当进程一次需要N个某类临界资源时，如果用记录型信号量，进程每次只能一次申请或释放一个临界资源，效率较低；每类资源数下限不同；对每类资源需求不同。因此引入信号量集：


### * 管程

* 出现原因：

    为了避免凡要使用临界资源的进程都自备同步操作P(s)和V(s), 将同步操作的机制和临界资源结合到一起，形成管程。

* 信号量能够解决的同步问题，用管程同样可以解决，而且更加简单

* 









## 进程通信

## 死锁
## 线程
# 4. *处理机调度

# 5. *存储管理
# 6. *设备管理

# 7. *文件系统管理

# 8. 操作系统安全







