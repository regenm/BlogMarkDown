---
title: Linuxç£ç›˜æ“ä½œ
date: 2025-07-14 17:50:39
tags: [ç¬”è®°, linux, system,command,è¿ç»´,ç£ç›˜æ“ä½œ]
categories: [è½¯ä»¶æŠ€æœ¯]
---

# Linux ç£ç›˜æ“ä½œæ€»è§ˆ

> å¸¸ç”¨å‘½ä»¤ï¼š`lsblk`ã€`fdisk`ã€`parted`ã€`mkfs`ã€`mount`ã€`blkid`ã€`df`ã€`lsblk`ã€`vim /etc/fstab`

------

##  æŸ¥çœ‹ç£ç›˜å’Œåˆ†åŒºä¿¡æ¯

### `lsblk`

æ˜¾ç¤ºå—è®¾å¤‡ï¼ˆdiskã€partï¼‰çš„ç»“æ„ï¼š

```bash
lsblk
```

ç¤ºä¾‹ï¼š

![image-20250715092022905](../images/Linux/è¿ç»´/disk/image-20250715092022905.png)

------

### `fdisk -l`

åˆ—å‡ºæ‰€æœ‰ç£ç›˜å’Œåˆ†åŒºçš„è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…å«åˆ†åŒºç±»å‹ã€UUID ç­‰ï¼‰ï¼š

```bash
fdisk -l
```

![image-20250715092323809](../images/Linux/è¿ç»´/disk/image-20250715092323809.png)

---



##  åˆ†åŒº

å‡è®¾è¦å¯¹ `/dev/sdb` æ–°ç¡¬ç›˜è¿›è¡Œåˆ†åŒºï¼š

### MBR åˆ†åŒº  `fdisk /dev/sdb`

äº¤äº’å¼å·¥å…·ï¼š

- `n` â†’ æ–°å»ºåˆ†åŒº
- `p` â†’ ä¸»åˆ†åŒº
- `1` â†’ åˆ†åŒºå·
- å›è½¦ â†’ é»˜è®¤ç¬¬ä¸€ä¸ªæ‰‡åŒº
- å›è½¦ â†’ é»˜è®¤æœ€åä¸€ä¸ªæ‰‡åŒºï¼ˆæˆ–è¾“å…¥ +100G æŒ‡å®šå¤§å°ï¼‰
- `w` â†’ å†™å…¥åˆ†åŒºè¡¨å¹¶é€€å‡º

![image-20250715092714083](../images/Linux/è¿ç»´/disk/image-20250715092714083.png)

![image-20250715092726925](../images/Linux/è¿ç»´/disk/image-20250715092726925.png)

å¯ä»¥å‘ç°å·²ç»åˆ›å»ºå¥½äº†sdb1

> âš  æ³¨æ„ï¼šGPT åˆ†åŒºè¡¨å¯ä»¥ç”¨ `parted` / `gdisk`ï¼Œå¤§ç£ç›˜ï¼ˆ>2TBï¼‰æ¨è GPTã€‚

### GPT  åˆ†åŒº`parted` å¤§å®¹é‡ä»¥åŠç°ä»£æœºå™¨æ¨è

```bash
parted /dev/sdb
mklabel gpt
mkpart primary xfs 0% 100%
```

![image-20250715093446008](../images/Linux/è¿ç»´/disk/image-20250715093446008.png)

* å¦‚æœæ˜¯å¤§å®¹é‡ç£ç›˜ï¼Œä¾‹å¦‚å‡ åTéœ€ä½¿ç”¨xfsæ–‡ä»¶ç³»ç»Ÿã€‚

### æŸ¥çœ‹ç£ç›˜åˆ†åŒºç±»å‹

```bash
parted /dev/sdb print
```

![image-20250715093327413](../images/Linux/è¿ç»´/disk/image-20250715093327413.png)

------



## æ ¼å¼åŒ–ï¼ˆåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼‰

å‡è®¾æ–°å»ºçš„åˆ†åŒºæ˜¯ `/dev/sdb1`ï¼š

### `mkfs` å·¥å…·ï¼š

- ext4ï¼š

```bash
mkfs.ext4 /dev/sdb1
```

![image-20250715093626175](../images/Linux/è¿ç»´/disk/image-20250715093626175.png)

- xfsï¼ˆé€‚åˆå¤§æ–‡ä»¶/é«˜æ€§èƒ½åœºæ™¯ï¼‰ï¼š

```bash
mkfs.xfs /dev/sdb1
```

- æŸ¥çœ‹æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿï¼š

```bash
ls /sbin/mkfs*
```

![image-20250715093712405](../images/Linux/è¿ç»´/disk/image-20250715093712405.png)

---

## æŒ‚è½½åˆ†åŒº

å‡è®¾è¦æŒ‚è½½åˆ° `/data`ï¼š

```bash
mkdir -p /data
mount /dev/sdb1 /data
```

æŸ¥çœ‹å½“å‰æŒ‚è½½æƒ…å†µï¼š

```bash
lsblk
df -h
```

![image-20250715093903586](../images/Linux/è¿ç»´/disk/image-20250715093903586.png)

![image-20250715093950133](../images/Linux/è¿ç»´/disk/image-20250715093950133.png)

---

## å¼€æœºè‡ªåŠ¨æŒ‚è½½

è·å–åˆ†åŒº UUIDï¼š

```bash
blkid /dev/sdb1
```

è¾“å‡ºï¼š

![image-20250715094012956](../images/Linux/è¿ç»´/disk/image-20250715094012956.png)

**å¤åˆ¶uuid**

ç¼–è¾‘ `/etc/fstab`ï¼š

```bash
vim /etc/fstab
```

æ·»åŠ ä¸€è¡Œï¼š

```
UUID=098f85d8-3753-444b-9d03-309052d9c645 /data ext4 defaults 0 0
```



- UUIDï¼šåˆ†åŒºå”¯ä¸€æ ‡è¯†ç¬¦
- `/data`ï¼šæŒ‚è½½ç‚¹
- `ext4`ï¼šæ–‡ä»¶ç³»ç»Ÿç±»å‹
- `defaults`ï¼šé»˜è®¤å‚æ•°ï¼ˆè¯»å†™ã€è‡ªåŠ¨æŒ‚è½½ç­‰ï¼‰
- `0 0`ï¼šæ˜¯å¦åš dump å’Œ fsck æ£€æŸ¥

æœ€åå¯ä»¥é€šè¿‡`reboot`æµ‹è¯•ä¸€ä¸‹æ˜¯å¦æˆåŠŸæŒ‚è½½

------

##  æ–‡ä»¶ç³»ç»ŸæŸ¥çœ‹ & æ£€æŸ¥

- æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µï¼š

```bash
df -h
```

- æŸ¥çœ‹åˆ†åŒºç±»å‹å’Œ UUIDï¼š

```bash
blkid
```

- æŸ¥çœ‹è¯¦ç»†æŒ‚è½½ä¿¡æ¯ï¼š

```bash
mount
```

- æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿï¼ˆä¾‹å¦‚ ext4ï¼‰ï¼š

```bash
fsck /dev/sdb1
```

------

## **æ€»ç»“ï¼šLinux ç£ç›˜å®Œæ•´æ“ä½œæµç¨‹**ï¼š

| æ­¥éª¤       | å‘½ä»¤                              | è¯´æ˜                     |
| ---------- | --------------------------------- | ------------------------ |
| æŸ¥çœ‹ç£ç›˜   | lsblk / fdisk -l                  | ç¡®è®¤è®¾å¤‡                 |
| åˆ†åŒº       | fdisk /dev/sdb                    | åˆ›å»ºæ–°åˆ†åŒº               |
|            | parted                            | åˆ›å»ºæ–°åˆ†åŒºã€æŸ¥çœ‹åˆ†åŒºç±»å‹ |
| æ ¼å¼åŒ–     | mkfs.ext4 /dev/sdb1               | åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ             |
| åˆ›å»ºæŒ‚è½½ç‚¹ | mkdir /data                       | æŒ‚è½½ç›®å½•                 |
| æŒ‚è½½       | mount /dev/sdb1 /data             | æ‰‹åŠ¨æŒ‚è½½                 |
| è‡ªåŠ¨æŒ‚è½½   | blkid è·å– UUID + ç¼–è¾‘ /etc/fstab | å¼€æœºè‡ªåŠ¨æŒ‚è½½             |

------

#### é™„ï¼š

1. è¡¨æ ¼ â‘ ï¼š**MBR å†…éƒ¨åˆ†åŒºç»“æ„**ï¼ˆä¸»åˆ†åŒº / æ‰©å±•åˆ†åŒº / é€»è¾‘åˆ†åŒº å¯¹æ¯”ï¼‰
2. è¡¨æ ¼ â‘¡ï¼š**MBR vs GPT åˆ†åŒºè¡¨ å¯¹æ¯”**

## ğŸ“¦ è¡¨æ ¼â‘ ï¼šMBR åˆ†åŒºç»“æ„

| ç±»å‹                | æ•°é‡é™åˆ¶                            | æ˜¯å¦å¯ç›´æ¥æŒ‚è½½ | ç”¨é€”ä¸ç‰¹ç‚¹                            |
| ------------------- | ----------------------------------- | -------------- | ------------------------------------- |
| ä¸»åˆ†åŒº (Primary)    | æœ€å¤š 4 ä¸ª                           | âœ… å¯ä»¥         | æœ€ç®€å•ç›´æ¥ï¼Œå¯ç›´æ¥æ ¼å¼åŒ–æŒ‚è½½          |
| æ‰©å±•åˆ†åŒº (Extended) | æœ€å¤š 1 ä¸ªï¼ˆå¿…é¡»å ä¸€ä¸ªä¸»åˆ†åŒºçš„ä½ç½®ï¼‰ | âŒ ä¸å¯ä»¥       | å®¹å™¨åˆ†åŒºï¼Œç”¨æ¥çªç ´æœ€å¤š 4 ä¸ªåˆ†åŒºçš„é™åˆ¶ |
| é€»è¾‘åˆ†åŒº (Logical)  | æ— é™ï¼ˆé€šå¸¸ /dev/sda5 å¼€å§‹ï¼‰         | âœ… å¯ä»¥         | å»ºåœ¨æ‰©å±•åˆ†åŒºå†…éƒ¨ï¼Œä¹Ÿå¯ç›´æ¥æ ¼å¼åŒ–æŒ‚è½½  |



------

## ğŸ§° è¡¨æ ¼â‘¡ï¼šMBR vs GPT åˆ†åŒºè¡¨

| ç‰¹ç‚¹           | MBR                                    | GPT                                |
| -------------- | -------------------------------------- | ---------------------------------- |
| æœ€å¤§æ”¯æŒå®¹é‡   | å•ç›˜æœ€å¤§çº¦ 2TB                         | ç†è®ºæ”¯æŒåˆ° 18EBï¼ˆå‡ ä¹æ— é™ï¼‰        |
| åˆ†åŒºæ€»æ•°       | æœ€å¤š 4 ä¸ªä¸»åˆ†åŒºï¼›è¶…è¿‡éœ€ç”¨æ‰©å±•+é€»è¾‘åˆ†åŒº | é»˜è®¤å¯å»º 128 ä¸ªåˆ†åŒºï¼ˆéƒ½å¹³ç­‰ï¼‰      |
| æ‰©å±•/é€»è¾‘åˆ†åŒº  | æœ‰                                     | æ—                                  |
| å®¹é”™           | æ—                                      | æœ‰ä¸»å¤‡åˆ†åŒºè¡¨ï¼Œæ›´å¯é                |
| å¯åŠ¨æ–¹å¼å…¼å®¹æ€§ | ä¼ ç»Ÿ BIOS å¯åŠ¨ï¼ˆåªæ”¯æŒ MBRï¼‰           | æ¨è UEFI å¯åŠ¨ï¼›ä¹Ÿèƒ½é…åˆ BIOS å¯åŠ¨ |
| ä½¿ç”¨åœºæ™¯       | å°ç›˜ï¼ˆâ‰¤2TBï¼‰ï¼Œè€ç³»ç»Ÿ                   | å¤§ç›˜ã€æ–°ç¡¬ä»¶ã€æ–°ç³»ç»Ÿ               |

---

# é—®é¢˜

# 1. ~~tmd~~æ­»æ´»æŒ‚ä¸ä¸Š

æƒ…æ™¯ï¼š

1. ä¸€å—1Tç£ç›˜sdb
2. æŒ‚è½½åˆ°`/data`
3. ç›´æ¥æŒ‚è½½æˆ–è€…æ˜¯fstabç”¨UUIDæŒ‚è½½éƒ½å¤±è´¥

è§£å†³æ–¹å¼ï¼š

1. å…ˆæŸ¥çœ‹ä¸€ä¸‹æ—¥å¿—ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆå¯¼è‡´çš„ã€‚

```
dmesg | tail -30
journalctl -xe | tail -30
```

ä¾‹å¦‚æˆ‘çš„ï¼š

```SPARQL
-- data.mount å•å…ƒå·²ç»“æŸåœæ­¢æ“ä½œã€‚
7æœˆ 16 15:26:52 localhost.localdomain kernel: EXT4-fs (sdb1): mounted filesystem with ordered data mode. Opts: (null)
7æœˆ 16 15:26:52 localhost.localdomain systemd[1]: data.mount: Unit is bound to inactive unit dev-disk-by\x2duuid-8d489e7f\x2d3f79\x2d4678\x2db082\x2d85fc6fe18c4.device. Stopping, too.
7æœˆ 16 15:26:52 localhost.localdomain systemd[1]: Unmounting /data...
-- Subject: data.mount å•å…ƒå·²å¼€å§‹åœæ­¢æ“ä½œ
-- Defined-By: systemd
-- Support: https://access.redhat.com/support
-- 
-- data.mount å•å…ƒå·²å¼€å§‹åœæ­¢æ“ä½œã€‚
7æœˆ 16 15:26:52 localhost.localdomain systemd[1]: data.mount: Succeeded.
-- Subject: Unit succeeded
-- Defined-By: systemd
-- Support: https://access.redhat.com/support
-- 
-- The unit data.mount has successfully entered the 'dead' state.
7æœˆ 16 15:26:52 localhost.localdomain systemd[1]: Unmounted /data.
-- Subject: data.mount å•å…ƒå·²ç»“æŸåœæ­¢æ“ä½œ
-- Defined-By: systemd
-- Support: https://access.redhat.com/support
```

è¿™ä¸€è¡Œ

`data.mount: Unit is bound to inactive unit dev-disk-by\x2duuid8d489e7f\x2d3f79\x2d4678\x2db082\x2d85fc6fe18c4.device. Stopping, too.`

å–‚ç»™Ai:

> å‡ºç°â€œdata.mountâ€å•å…ƒåœ¨ä¸åœæŒ‚è½½å¸è½½çš„æƒ…å†µï¼Œè¯´æ˜ systemd é‡Œå¯èƒ½æ®‹ç•™äº†è€çš„æŒ‚è½½å•å…ƒé…ç½®ï¼Œç»‘å®šäº†ä¹‹å‰çš„é”™è¯¯ UUIDã€‚

* æ¥ä¸‹æ¥ï¼š

```bash
# å–æ¶ˆæ®‹ç•™çš„ systemd æŒ‚è½½å•å…ƒ
systemctl stop data.mount
systemctl disable data.mount
# æ¸…ç†å¯èƒ½çš„æ®‹ç•™æ–‡ä»¶
ls /etc/systemd/system/data.mount
ls /usr/lib/systemd/system/data.mount
# å¦‚æœå­˜åœ¨ï¼Œæ‰§è¡Œ
rm /etc/systemd/system/data.mount
# mv /etc/systemd/system/data.mount /root/
mv /etc/systemd/system/data.mount /root/
systemctl daemon-reload

```

ç„¶åå°±å¯ä»¥æŒ‚ä¸Šäº†ï¼Œå¯èƒ½æ˜¯ç¬¬ä¸€æ¬¡æ²¡æ“ä½œå¥½ï¼Œä¹±æŒ‚ä¹‹åæ›´æŒ‚ä¸ä¸Šäº†ã€‚æ–°æŠ€å·§ï¼š**å–æ¶ˆæ®‹ç•™çš„ systemd æŒ‚è½½å•å…ƒ**

